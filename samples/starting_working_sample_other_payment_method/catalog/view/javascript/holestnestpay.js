/*Holest Engineering NestPay for OpenCart 3+ / VERSION 1.0.0.*/
if(window.jQuery){
	//FIX USER LOGED OUT AFTER RETURN FROM BANK PAGE/////////////////
	try{
		(function(cName, cValue) {
        let date = new Date();
        date.setTime(date.getTime() + (7 * 24 * 60 * 60 * 1000));
        const expires = "expires=" + date.toUTCString();
        document.cookie = cName + "=" + cValue + "; " + expires + "; path=/";
		})('OCSESSID',(function(name) {
		  const value = `; ${document.cookie}`;
		  const parts = value.split(`; ${name}=`);
		  if (parts.length === 2) return parts.pop().split(';').shift();
		})("OCSESSID"));
	}catch(ex){
		
	}
	//END FIX//////////////////////////////////////////////////////////
	var hlstnpShowMessageCallback=null;function hlstnpShowMessage(e,t,s){if(!jQuery("div.hlstnp_message")[0]){jQuery('<div class="hlstnp_message" style="display:none;position: fixed;top: 0;left: 0;background: rgba(0,0,0,0.3);width: 100%;height: 100%;z-index: 99999; text-align: center;"><div class="hlstnp_message_content_wrapper" style="max-width: 80vw;max-height: 80vh;text-align: center;padding: 15px;border-radius: 4px;background: rgba(244, 244, 243, 0.9);display: inline-block; width: 640px;margin-top: 10vh;"><div class="hlstnp_message_content" style="max-height: 70vh;overflow-y: auto;min-height: 30vh;padding: 15px;text-align: left;"></div><button class="hlstnp_message_content_cmd" style="min-width: 120px;font-size: 22px;border: none;padding: 8px;border-radius: 5px;">âœ”</button></div></div>').appendTo(jQuery("body"));var n=document.createElement("style");n.innerHTML=".hlstnp_message_show { transition-property:opacity; transition-duration:0.5s; opacity:1!important; } .hlstnp_message_content_cmd{cursor:pointer; transition-property:background; transition-duration:0.5s;} .hlstnp_message_content_cmd:hover{ background:rgba(0,0,0,0.4);}",document.head.appendChild(n)}s?jQuery(".hlstnp_message_content_cmd").css("color","green"):jQuery(".hlstnp_message_content_cmd").css("color","red"),hlstnpShowMessageCallback=t||null,jQuery(".hlstnp_message_content").html(e),jQuery("div.hlstnp_message").css("opacity",0),jQuery("div.hlstnp_message").css("display","block"),jQuery("div.hlstnp_message").addClass("hlstnp_message_show")}jQuery(document).on("click",".hlstnp_message_content_cmd",function(e){jQuery("div.hlstnp_message").removeClass("hlstnp_message_show"),jQuery("div.hlstnp_message").css("display","none"),hlstnpShowMessageCallback&&hlstnpShowMessageCallback()}),jQuery(document).ready(function(){if(jQuery(".find_admin_url")[0]){var e=jQuery(".find_admin_url").attr("src"),t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="text",t.onload=function(){window.apelm=null,eval.apply(window,["var "+this.responseText.split("var ")[1]]),eval.apply(window,[apelm]),hlstintl()},t.send(null)}jQuery("FORM.holestnestpay-settings")[0]&&(jQuery("#refresh_exchange_rate_field").prop("checked")&&jQuery("#conversion_rate_adjust_field").closest(".form-group").show(),jQuery(document).on("change","#refresh_exchange_rate_field",function(e){jQuery("#refresh_exchange_rate_field").prop("checked")?jQuery("#conversion_rate_adjust_field").closest(".form-group").show():jQuery("#conversion_rate_adjust_field").closest(".form-group").hide()})),jQuery(document).on("click",".payment_holestnestpay_pay_button[order_id]",function(e){localStorage.payment_holestnestpay_check_order_id=jQuery(this).attr("order_id")}),localStorage.payment_holestnestpay_check_order_id&&jQuery.ajax({url:(jQuery("base").attr("href")||"")+"index.php?route=extension/payment/holestnestpay/checkorder",method:"POST",jsonp:!1,dataType:"json",data:{order_id:localStorage.payment_holestnestpay_check_order_id},success:function(e){e&&(e.console_error&&console.log(e.error),e.complete&&delete localStorage.payment_holestnestpay_check_order_id,e.complete_with_message?hlstnpShowMessage(e.complete_with_message,function(){delete localStorage.payment_holestnestpay_check_order_id},e.success):e.message&&hlstnpShowMessage(e.message,null,!1),e.redirect&&window.location.href.replace("http://","").replace("https://","").replace("www.","")!=e.redirect.replace("http://","").replace("https://","").replace("www.","")&&(-1<e.redirect.indexOf("http")?window.location.href=e.redirect:window.location.href=(jQuery("base").attr("href")||"")+e.redirect))},error:function(e,t,s){console.log("payment_holestnestpay can not check order statuses!")}})});
}